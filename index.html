<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>QuantumExec — Phase 1</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#0b0f14;
      --panel:#121820;
      --panel-2:#0f141b;
      --fg:#e6eef8;
      --muted:#9fb3c8;
      --line:#1f2a37;
      --accent:#10b981;
      --accent-2:#22c55e;
      --danger:#ef4444;
      --warn:#f59e0b;
      --ok:#22c55e;
      --mono: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      --sans: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      --radius:12px;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:var(--sans);
      background:linear-gradient(180deg,#0a0e13, #0b1118 30%, #0b0f14 100%); color:var(--fg);
    }
    .wrap{max-width:1080px; margin:28px auto; padding:0 16px;}
    header{
      display:flex; align-items:center; justify-content:space-between; gap:16px;
      background:linear-gradient(180deg, #0f1620, #0d141c);
      padding:16px 18px; border:1px solid var(--line);
      border-radius: var(--radius); box-shadow:var(--shadow);
    }
    .brand{display:flex; align-items:center; gap:12px}
    .logo{
      width:36px; height:36px; border-radius:9px; background:
        radial-gradient(120% 120% at 20% 20%, rgba(16,185,129,.45), transparent 55%),
        radial-gradient(120% 120% at 80% 80%, rgba(34,197,94,.45), transparent 55%),
        linear-gradient(135deg, #0b141d, #0a1017);
      border:1px solid #1e2a36;
      box-shadow: inset 0 0 20px rgba(16,185,129,.25), 0 4px 20px rgba(0,0,0,.35);
    }
    h1{font-size:18px; margin:0; letter-spacing:.2px}
    .subtitle{color:var(--muted); font-size:13px; margin-top:2px}

    .right{ text-align:right }
    .actions{display:flex; gap:8px; flex-wrap:wrap}
    .btn{
      appearance:none; border:1px solid #233041; background:#101722; color:var(--fg);
      padding:9px 12px; border-radius:10px; cursor:pointer; transition:.2s transform,.2s background,.2s border;
      box-shadow: 0 6px 18px rgba(0,0,0,.25);
      font-weight:600; font-size:14px;
    }
    .btn:hover{ transform: translateY(-1px); background:#0f1926; }
    .btn:active{ transform: translateY(0); }
    .btn.primary{ background:linear-gradient(180deg,#10b981,#16a34a); border-color:#118a6a; color:white; }
    .btn.primary:hover{ filter:brightness(1.05); }
    .btn.ghost{ background:transparent; border-color:#243140; }
    .btn.danger{ border-color:#3a1f22; background: #1a0f11; color:#ffb4b4; }

    .mode-switch{
      display:flex; align-items:center; gap:10px; flex-wrap:wrap;
    }
    .seg{
      display:inline-flex; background:#0f1620; border:1px solid var(--line);
      border-radius:12px; overflow:hidden;
    }
    .seg button{
      border:0; background:transparent; color:var(--muted); padding:8px 12px; font-weight:700; cursor:pointer;
    }
    .seg button.active{
      color:#0b1611; background: linear-gradient(180deg,#10b981,#22c55e);
    }

    nav.tabs{
      display:flex; gap:10px; margin:16px 0 12px;
      background: #0f1620; border:1px solid var(--line); border-radius: var(--radius); padding:8px;
    }
    .tab{
      padding:10px 14px; border-radius:10px; color:var(--muted); font-weight:700; cursor:pointer;
      border:1px solid transparent; user-select:none;
    }
    .tab.active{ color:#0b1611; background: linear-gradient(180deg,#10b981,#22c55e); border-color:#11996b; }

    .view{ display:none; }
    .view.active{ display:block; }

    .grid{ display:grid; gap:16px; grid-template-columns: repeat(12, 1fr); }
    .panel{
      grid-column: span 12; background:linear-gradient(180deg,#0f1620,#0d141c);
      border:1px solid var(--line); border-radius: var(--radius); padding:16px; box-shadow:var(--shadow);
      overflow: hidden; /* keep children contained */
    }
    @media (min-width: 900px){
      .panel.half{ grid-column: span 6; }
    }
    .panel h2{font-size:16px; margin:0 0 10px 0}
    .hint{color:var(--muted); font-size:12px; margin-bottom:10px}
    .row{display:flex; gap:8px; flex-wrap:wrap; margin:8px 0}
    .row .field{flex:1; min-width:180px}
    label{display:block; font-size:12px; color:var(--muted); margin-bottom:6px}
    input,select,textarea{
      width:100%; padding:10px 12px; border-radius:10px; border:1px solid #253243; background: #0e1520; color:var(--fg);
      outline:none; transition:.2s border,.2s background;
      font-size:14px;
    }
    textarea{ min-height:92px; resize:vertical; }
    input::placeholder, textarea::placeholder{ color:#5c738b }

    .table-wrap{
      border:1px solid #1f2a37; border-radius:10px; overflow:auto; /* scroll inside */
      max-height:320px; background:#0e1722;
    }
    table{ width:100%; border-collapse:collapse; min-width:640px; }
    th, td{ text-align:left; padding:10px 12px; border-bottom:1px solid #1f2a37; }
    th{
      font-size:12px; color:#8fa6bd; background:#101824; position:sticky; top:0; z-index:1;
    }
    tr:hover td{ background:#0f1824 }
    .chip{
      display:inline-flex; align-items:center; gap:6px; padding:4px 8px; border-radius:999px; font-size:12px; font-weight:700;
      border:1px solid #233041; background:#0e1722; color:#a9c2d8;
    }
    .chip.ok{ color:#b9f6d4; border-color:#1f3a33; background: rgba(34,197,94,.08)}
    .chip.warn{ color:#ffe6b3; border-color:#3a2f1f; background: rgba(245,158,11,.08)}
    .chip.bad{ color:#ffc5c5; border-color:#3a1f22; background: rgba(239,68,68,.08)}
    .kbd{font-family:var(--mono); font-size:11px; color:#b7c9db; background:#0c131b; padding:2px 6px; border-radius:6px; border:1px solid #213043}
    .footer-note{color:#7f9ab5; font-size:12px; margin-top:12px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>QuantumExec</h1>
          <div class="subtitle" id="appSubtitle">Phase 1 — human resources scheduling, fast and fair</div>
        </div>
      </div>
      <div class="actions">
        <div class="mode-switch">
          <div class="seg" role="tablist" aria-label="Mode">
            <button id="modeHR" class="active" role="tab" aria-selected="true">Human Resources</button>
            <button id="modeSC" role="tab" aria-selected="false">Supply Chain</button>
          </div>
        </div>
        <button class="btn ghost" id="seedBtn" title="Load sample data">Load Demo Data</button>
        <button class="btn" id="quantumBtn" title="Quantum-ready stub">Quantum Assist</button>
        <button class="btn danger" id="resetBtn" title="Clear everything for this mode">Reset</button>
        <button class="btn primary" id="optBtnTop">Optimize</button>
      </div>
    </header>

    <nav class="tabs" role="tablist" aria-label="Primary">
      <div class="tab active" data-tab="tasks" role="tab" aria-selected="true" id="tabTasks">Tasks</div>
      <div class="tab" data-tab="resources" role="tab" aria-selected="false" id="tabResources">Resources</div>
      <div class="tab" data-tab="constraints" role="tab" aria-selected="false" id="tabConstraints">Constraints</div>
      <div class="tab" data-tab="output" role="tab" aria-selected="false" id="tabOutput">Output</div>
    </nav>

    <!-- TASKS VIEW -->
    <section id="view-tasks" class="view active">
      <div class="grid">
        <div class="panel half">
          <h2 id="newTaskTitle">New Task</h2>
          <div class="hint" id="newTaskHint">Required Skills comma-separated (e.g., design, figma).</div>
          <div class="row">
            <div class="field"><label id="lblTitle">Title</label><input id="tTitle" placeholder="Design marketing brochure" /></div>
            <div class="field">
              <label id="lblPriority">Priority</label>
              <select id="tPriority">
                <option>High</option><option>Medium</option><option>Low</option>
              </select>
            </div>
            <div class="field"><label id="lblSkills">Required Skills</label><input id="tSkills" placeholder="design, figma, print" /></div>
          </div>
          <div class="row">
            <div class="field"><label id="lblHours">Est. Hours</label><input id="tHours" type="number" step="0.25" placeholder="4" /></div>
            <div class="field"><label id="lblDue">Due Date</label><input id="tDue" type="date" /></div>
            <div class="field"><label id="lblAssignee">Assignee (optional)</label><input id="tAssignee" placeholder="Sarah Kim" /></div>
          </div>
          <div class="row">
            <button class="btn" id="addTaskBtn">Add Task</button>
          </div>
        </div>

        <div class="panel half">
          <h2 id="tasksTitle">Tasks</h2>
          <div class="hint" id="tasksHint">Sorted in Output by Priority, Due, then Hours. Use Optimize to assign fairly.</div>
          <div class="table-wrap" aria-label="Tasks table container">
            <table id="tasksTable" aria-label="Tasks table">
              <thead>
                <tr>
                  <th id="thTask">Task</th><th id="thPriority">Priority</th><th id="thSkills">Skills</th><th id="thHours">Hours</th><th id="thDue">Due</th><th id="thAssignee">Assignee</th><th></th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div class="footer-note">Tip: use <span class="kbd">Load Demo Data</span> to see it in action.</div>
        </div>
      </div>
    </section>

    <!-- RESOURCES VIEW -->
    <section id="view-resources" class="view">
      <div class="grid">
        <div class="panel half">
          <h2 id="newResourceTitle">New Resource</h2>
          <div class="hint" id="resourcesHint">Add people and their skills. Max Tasks caps daily workload.</div>
          <div class="row">
            <div class="field"><label id="lblResName">Name</label><input id="rName" placeholder="Sarah Kim" /></div>
            <div class="field"><label id="lblResSkills">Skills</label><input id="rSkills" placeholder="design, figma, print" /></div>
            <div class="field"><label id="lblResMax">Max Tasks</label><input id="rMax" type="number" placeholder="3" /></div>
          </div>
          <div class="row">
            <button class="btn" id="addResourceBtn">Add Resource</button>
          </div>
        </div>

        <div class="panel half">
          <h2 id="resourcesTitle">Resources</h2>
          <div class="hint">Live workload updates after Optimize. Red chip = overloaded.</div>
          <div class="table-wrap" aria-label="Resources table container">
            <table id="resourcesTable" aria-label="Resources table">
              <thead>
                <tr>
                  <th id="thResName">Name</th><th id="thResSkills">Skills</th><th id="thResMax">Max Tasks</th><th>Current Load</th><th>Status</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- CONSTRAINTS VIEW -->
    <section id="view-constraints" class="view">
      <div class="grid">
        <div class="panel">
          <h2>Constraints</h2>
          <div class="hint" id="constraintsHint">Capture practical rules you follow. Phase 1 stores these as guidance.</div>
          <div class="row">
            <div class="field"><label>Guideline</label><input id="cText" placeholder="Max 2 client calls per day" /></div>
            <div class="field right"><label>&nbsp;</label><button class="btn" id="addConstraintBtn">Add</button></div>
          </div>
          <div class="table-wrap">
            <table id="constraintsTable" aria-label="Constraints table">
              <thead><tr><th>Constraint</th><th></th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
          <div class="footer-note" id="constraintsExamples">Examples: “No Friday deployments”, “Safety stock for SKU‑24oz ≥ 50”.</div>
        </div>
      </div>
    </section>

    <!-- OUTPUT VIEW -->
    <section id="view-output" class="view">
      <div class="grid">
        <div class="panel">
          <h2 id="outputTitle">Output — Optimized Schedule</h2>
          <div class="row">
            <button class="btn primary" id="optBtn">Run Optimize</button>
            <div class="hint" id="outputHint">Rule‑based logic: skills match → not overloaded → lowest load → keep valid current assignee.</div>
          </div>
          <div class="table-wrap" aria-label="Output table container">
            <table id="outputTable" aria-label="Optimized output">
              <thead>
                <tr><th id="thOutDate">Date</th><th id="thOutResource">Resource</th><th id="thOutTask">Task</th><th id="thOutPriority">Priority</th><th id="thOutHours">Hours</th><th>Status</th></tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div class="footer-note">Phase 1 is deterministic and offline. Phase 2 can add time windows, cost, routes, and Quantum suggestions.</div>
        </div>
      </div>
    </section>
  </div>

  <script>
    // ---------- Mode-aware config ----------
    const MODE_KEY = 'qx_mode_v1';
    const priorityRank = { High:3, Medium:2, Low:1 };

    const text = {
      hr: {
        subtitle: 'Phase 1 — human resources scheduling, fast and fair',
        tabs: { tasks:'Tasks', resources:'Resources', constraints:'Constraints', output:'Output' },
        newTaskTitle: 'New Task',
        newTaskHint: 'Required Skills comma-separated (e.g., design, figma).',
        fields: { title:'Title', skills:'Required Skills', hours:'Est. Hours', due:'Due Date', assignee:'Assignee (optional)', priority:'Priority' },
        tasksTitle: 'Tasks',
        tasksHint: 'Sorted in Output by Priority, Due, then Hours. Use Optimize to assign fairly.',
        resources: { newTitle:'New Resource', title:'Resources', hint:'Add people and their skills. Max Tasks caps daily workload.', name:'Name', skills:'Skills', max:'Max Tasks' },
        tableHeaders: { task:'Task', skills:'Skills', assignee:'Assignee', due:'Due', hours:'Hours', priority:'Priority', resName:'Name', resSkills:'Skills', resMax:'Max Tasks', outRes:'Resource', outTask:'Task', outDate:'Date', outPriority:'Priority', outHours:'Hours' },
        constraintsHint: 'Capture practical rules you follow. Phase 1 stores these as guidance.',
        constraintsExamples: 'Examples: “No Friday deployments”, “Max 2 client calls per day”.',
        outputTitle: 'Output — Optimized Schedule',
        outputHint: 'Rule‑based: skills match → not overloaded → lowest load → keep valid current assignee.',
        assigneePlaceholder: 'Sarah Kim',
        taskPlaceholder: 'Design marketing brochure',
        skillsPlaceholder: 'design, figma, print',
      },
      sc: {
        subtitle: 'Phase 1 — supply chain fulfillment for SMBs, simple and clear',
        tabs: { tasks:'Orders', resources:'Suppliers', constraints:'Constraints', output:'Plan' },
        newTaskTitle: 'New Order',
        newTaskHint: 'Required SKUs or capabilities (e.g., sku-24oz, packaging).',
        fields: { title:'Order Name', skills:'Required SKUs or Capabilities', hours:'Est. Hours', due:'Promised Date', assignee:'Supplier (optional)', priority:'Urgency' },
        tasksTitle: 'Orders',
        tasksHint: 'Plan orders by urgency, promise date, then effort. Optimize to assign to best supplier.',
        resources: { newTitle:'New Supplier', title:'Suppliers', hint:'Add suppliers, catalogs, and daily order capacity.', name:'Supplier', skills:'Catalog SKUs / Capabilities', max:'Max Orders' },
        tableHeaders: { task:'Order', skills:'Requirements', assignee:'Supplier', due:'Promised', hours:'Hours', priority:'Urgency', resName:'Supplier', resSkills:'Catalog / Capabilities', resMax:'Max Orders', outRes:'Supplier', outTask:'Order', outDate:'Date', outPriority:'Urgency', outHours:'Hours' },
        constraintsHint: 'Capture practical rules (lead times, blackout days, safety stock). Phase 1 stores these as guidance.',
        constraintsExamples: 'Examples: “No Friday deliveries”, “Safety stock for SKU‑24oz ≥ 50”.',
        outputTitle: 'Fulfillment Plan',
        outputHint: 'Rule‑based: capability match → not over capacity → lowest load → keep valid current supplier.',
        assigneePlaceholder: 'Acme Packaging',
        taskPlaceholder: 'Fulfill 24oz cold cups',
        skillsPlaceholder: 'sku-24oz, packaging',
      }
    };

    // ---------- Keys per mode ----------
    const KEYS = (mode) => ({
      tasks: `qx_${mode}_tasks_v1`,
      resources: `qx_${mode}_resources_v1`,
      constraints: `qx_${mode}_constraints_v1`
    });

    let mode = localStorage.getItem(MODE_KEY) || 'hr';
    let tasks = [];
    let resources = [];
    let constraints = [];

    // ---------- Utilities ----------
    function save(key, val){ localStorage.setItem(key, JSON.stringify(val)); }
    function load(key){ try{ return JSON.parse(localStorage.getItem(key)); }catch{ return null; } }
    const clone = (x) => JSON.parse(JSON.stringify(x));
    const normSkills = (sArr) => (sArr||[]).map(s=>String(s).toLowerCase().trim()).filter(Boolean);
    const hasAllSkills = (resource, required) => {
      const rs = new Set(normSkills(resource.skills));
      return normSkills(required).every(s => rs.has(s));
    };
    const formatDate = (d) => d ? new Date(d).toLocaleDateString() : '';
    function byId(id){ return document.getElementById(id); }
    function escapeHtml(s){ return String(s ?? '').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

    function currentLoad(resourceName){
      return tasks.filter(t => t.assignee === resourceName).length;
    }
    function statusChip(load, max){
      if ((max ?? 0) === 0) return '<span class="chip warn">No capacity</span>';
      if (load > max) return '<span class="chip bad">Overloaded</span>';
      if (load === max) return '<span class="chip warn">At capacity</span>';
      return '<span class="chip ok">OK</span>';
    }

    // ---------- Rendering ----------
    function renderTasks(){
      const tb = document.querySelector('#tasksTable tbody');
      tb.innerHTML = '';
      tasks.forEach((t, idx) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${escapeHtml(t.title)}</td>
          <td>${escapeHtml(t.priority)}</td>
          <td>${escapeHtml((t.skills||[]).join(', '))}</td>
          <td>${t.hours ?? ''}</td>
          <td>${formatDate(t.due)}</td>
          <td>${escapeHtml(t.assignee||'')}</td>
          <td class="right">
            <button class="btn ghost" title="Unassign" onclick="unassignTask(${idx})">Unassign</button>
            <button class="btn" title="Delete" onclick="deleteTask(${idx})">Delete</button>
          </td>`;
        tb.appendChild(tr);
      });
    }
    function renderResources(){
      const tb = document.querySelector('#resourcesTable tbody');
      tb.innerHTML = '';
      resources.forEach((r) => {
        const load = currentLoad(r.name);
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${escapeHtml(r.name)}</td>
          <td>${escapeHtml((r.skills||[]).join(', '))}</td>
          <td>${r.maxTasks ?? 0}</td>
          <td>${load}</td>
          <td>${statusChip(load, r.maxTasks ?? 0)}</td>
        `;
        tb.appendChild(tr);
      });
    }
    function renderConstraints(){
      const tb = document.querySelector('#constraintsTable tbody');
      tb.innerHTML = '';
      constraints.forEach((c, idx) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${escapeHtml(c.text)}</td>
                        <td class="right"><button class="btn" onclick="deleteConstraint(${idx})">Delete</button></td>`;
        tb.appendChild(tr);
      });
    }
    function renderOutput(){
      const tb = document.querySelector('#outputTable tbody');
      tb.innerHTML = '';
      const copy = clone(tasks);
      copy.sort((a,b)=>{
        const pr = priorityRank[b.priority] - priorityRank[a.priority];
        if (pr !== 0) return pr;
        const ad = (a.due? new Date(a.due).getTime(): Infinity);
        const bd = (b.due? new Date(b.due).getTime(): Infinity);
        if (ad !== bd) return ad - bd;
        return (a.hours||0) - (b.hours||0);
      });
      copy.forEach(t=>{
        const row = document.createElement('tr');
        const status = t.assignee && t.assignee!=="Unassigned" ? '<span class="chip ok">Assigned</span>' : '<span class="chip warn">Unassigned</span>';
        row.innerHTML = `
          <td>${formatDate(t.due)}</td>
          <td>${escapeHtml(t.assignee||'')}</td>
          <td>${escapeHtml(t.title)}</td>
          <td>${escapeHtml(t.priority)}</td>
          <td>${t.hours ?? ''}</td>
          <td>${status}</td>
        `;
        tb.appendChild(row);
      });
    }
    function renderAll(){
      renderTasks(); renderResources(); renderConstraints(); renderOutput();
    }

    // ---------- Actions ----------
    function addTask(){
      const title = byId('tTitle').value.trim();
      if(!title) return;
      const t = {
        title,
        priority: byId('tPriority').value,
        skills: normSkills(byId('tSkills').value.split(',')),
        hours: parseFloat(byId('tHours').value || '0'),
        due: byId('tDue').value || '',
        assignee: byId('tAssignee').value.trim() || ''
      };
      tasks.push(t); save(KEYS(mode).tasks, tasks); clearTaskForm(); renderAll();
    }
    function deleteTask(idx){
      tasks.splice(idx,1); save(KEYS(mode).tasks, tasks); renderAll();
    }
    function unassignTask(idx){
      tasks[idx].assignee = ''; save(KEYS(mode).tasks, tasks); renderAll();
    }
    function addResource(){
      const name = byId('rName').value.trim();
      if(!name) return;
      const r = {
        name,
        skills: normSkills(byId('rSkills').value.split(',')),
        maxTasks: parseInt(byId('rMax').value || '0',10)
      };
      resources.push(r); save(KEYS(mode).resources, resources); clearResourceForm(); renderAll();
    }
    function addConstraint(){
      const text = byId('cText').value.trim();
      if(!text) return;
      constraints.push({text}); save(KEYS(mode).constraints,constraints); byId('cText').value=''; renderAll();
    }
    function deleteConstraint(idx){
      constraints.splice(idx,1); save(KEYS(mode).constraints,constraints); renderAll();
    }

    function optimize(){
      const loadMap = Object.fromEntries(resources.map(r => [r.name, 0]));
      tasks.forEach(t => { if (t.assignee && loadMap[t.assignee] !== undefined) loadMap[t.assignee] += 1; });

      const order = tasks.map((t,i)=>({t, i}));
      order.sort((a,b)=>{
        const pr = priorityRank[b.t.priority] - priorityRank[a.t.priority];
        if (pr !== 0) return pr;
        const ad = (a.t.due? new Date(a.t.due).getTime(): Infinity);
        const bd = (b.t.due? new Date(b.t.due).getTime(): Infinity);
        if (ad !== bd) return ad - bd;
        return (a.t.hours||0) - (b.t.hours||0);
      });

      const resIndex = Object.fromEntries(resources.map((r,i)=>[r.name, i]));

      order.forEach(({t})=>{
        if (t.assignee && resIndex[t.assignee] !== undefined){
          const r = resources[resIndex[t.assignee]];
          const withinCap = (loadMap[r.name] < (r.maxTasks ?? 0));
          if (hasAllSkills(r, t.skills) && withinCap){
            loadMap[r.name] += 1;
            return;
          }
        }
        const eligible = resources
          .map(r => ({ r, load: loadMap[r.name] ?? 0 }))
          .filter(x => hasAllSkills(x.r, t.skills) && x.load < (x.r.maxTasks ?? 0))
          .sort((a,b)=> a.load - b.load);

        if (eligible.length){
          t.assignee = eligible[0].r.name;
          loadMap[t.assignee] = (loadMap[t.assignee] ?? 0) + 1;
        } else {
          t.assignee = 'Unassigned';
        }
      });

      save(KEYS(mode).tasks, tasks);
      renderAll();
    }

    function quantumAssist(){
      alert('Quantum Assist placeholder — Phase 2: connect Quantum API here for suggestions.');
    }

    // ---------- Tabs (single-view) ----------
    function activateTab(name){
      document.querySelectorAll('.tab').forEach(t=>{
        const isActive = t.getAttribute('data-tab') === name;
        t.classList.toggle('active', isActive);
        t.setAttribute('aria-selected', isActive ? 'true' : 'false');
      });
      document.querySelectorAll('.view').forEach(v=>v.classList.remove('active'));
      const view = document.getElementById('view-' + name);
      if (view) view.classList.add('active');
    }

    // ---------- Mode switch ----------
    function applyText(){
      const tx = text[mode];

      byId('appSubtitle').textContent = tx.subtitle;

      // Tabs
      byId('tabTasks').textContent = tx.tabs.tasks;
      byId('tabResources').textContent = tx.tabs.resources;
      byId('tabConstraints').textContent = tx.tabs.constraints;
      byId('tabOutput').textContent = tx.tabs.output;

      // New Task panel
      byId('newTaskTitle').textContent = tx.newTaskTitle;
      byId('newTaskHint').textContent = tx.newTaskHint;
      byId('lblTitle').textContent = tx.fields.title;
      byId('lblPriority').textContent = tx.fields.priority;
      byId('lblSkills').textContent = tx.fields.skills;
      byId('lblHours').textContent = tx.fields.hours;
      byId('lblDue').textContent = tx.fields.due;
      byId('lblAssignee').textContent = tx.fields.assignee;
      byId('tTitle').placeholder = tx.taskPlaceholder;
      byId('tSkills').placeholder = tx.skillsPlaceholder;
      byId('tAssignee').placeholder = tx.assigneePlaceholder;

      // Tasks table headers and title
      byId('tasksTitle').textContent = tx.tasksTitle;
      byId('tasksHint').textContent = tx.tasksHint;
      byId('thTask').textContent = tx.tableHeaders.task;
      byId('thPriority').textContent = tx.tableHeaders.priority;
      byId('thSkills').textContent = tx.tableHeaders.skills;
      byId('thHours').textContent = tx.tableHeaders.hours;
      byId('thDue').textContent = tx.tableHeaders.due;
      byId('thAssignee').textContent = tx.tableHeaders.assignee;

      // Resources
      byId('newResourceTitle').textContent = tx.resources.newTitle;
      byId('resourcesTitle').textContent = tx.resources.title;
      byId('resourcesHint').textContent = tx.resources.hint;
      byId('lblResName').textContent = tx.resources.name;
      byId('lblResSkills').textContent = tx.resources.skills;
      byId('lblResMax').textContent = tx.resources.max;
      byId('thResName').textContent = tx.tableHeaders.resName;
      byId('thResSkills').textContent = tx.tableHeaders.resSkills;
      byId('thResMax').textContent = tx.tableHeaders.resMax;

      // Constraints help
      byId('constraintsHint').textContent = tx.constraintsHint;
      byId('constraintsExamples').textContent = tx.constraintsExamples;

      // Output
      byId('outputTitle').textContent = tx.outputTitle;
      byId('outputHint').textContent = tx.outputHint;
      byId('thOutDate').textContent = tx.tableHeaders.outDate;
      byId('thOutResource').textContent = tx.tableHeaders.outRes;
      byId('thOutTask').textContent = tx.tableHeaders.outTask;
      byId('thOutPriority').textContent = tx.tableHeaders.outPriority;
      byId('thOutHours').textContent = tx.tableHeaders.outHours;

      // Mode buttons state
      byId('modeHR').classList.toggle('active', mode==='hr');
      byId('modeHR').setAttribute('aria-selected', mode==='hr' ? 'true':'false');
      byId('modeSC').classList.toggle('active', mode==='sc');
      byId('modeSC').setAttribute('aria-selected', mode==='sc' ? 'true':'false');
    }

    function loadModeData(){
      tasks = load(KEYS(mode).tasks) ?? [];
      resources = load(KEYS(mode).resources) ?? [];
      constraints = load(KEYS(mode).constraints) ?? [];
    }

    function setMode(next){
      if (next !== 'hr' && next !== 'sc') return;
      mode = next;
      localStorage.setItem(MODE_KEY, mode);
      applyText();
      loadModeData();
      renderAll();
    }

    // ---------- Forms ----------
    function clearTaskForm(){ ['tTitle','tSkills','tHours','tDue','tAssignee'].forEach(id=>byId(id).value=''); byId('tPriority').value='High'; }
    function clearResourceForm(){ ['rName','rSkills','rMax'].forEach(id=>byId(id).value=''); }

    // ---------- Demo seed ----------
    function seedDemo(){
      if (mode === 'hr'){
        tasks = [
          { title:'Design Marketing Brochure', priority:'High', skills:normSkills(['design','figma','print']), hours:6, due: datePlus(2), assignee:'' },
          { title:'Client Onboarding Call', priority:'High', skills:normSkills(['client','call','onboarding']), hours:1, due: datePlus(3), assignee:'' },
          { title:'Website Banner Update', priority:'Medium', skills:normSkills(['design','web']), hours:3, due: datePlus(5), assignee:'' },
          { title:'Quarterly Report Draft', priority:'Low', skills:normSkills(['excel','analysis']), hours:4, due: datePlus(7), assignee:'' }
        ];
        resources = [
          { name:'Sarah Kim', skills:normSkills(['design','figma','print','web']), maxTasks:3 },
          { name:'James Lee', skills:normSkills(['client','call','onboarding','sales']), maxTasks:4 },
          { name:'Alex Chen', skills:normSkills(['excel','analysis','sql']), maxTasks:2 }
        ];
        constraints = [
          { text:'Max 2 client calls per day' },
          { text:'Design tasks require Designer availability ≥ 50%' }
        ];
      } else {
        tasks = [
          { title:'Fulfill 24oz Cold Cups', priority:'High', skills:normSkills(['sku-24oz','packaging']), hours:5, due: datePlus(2), assignee:'' },
          { title:'Deliver Paper Lids', priority:'Medium', skills:normSkills(['sku-lid','delivery']), hours:2, due: datePlus(4), assignee:'' },
          { title:'Assemble Starter Kits', priority:'High', skills:normSkills(['kitting','packaging']), hours:6, due: datePlus(5), assignee:'' },
          { title:'Restock Napkins', priority:'Low', skills:normSkills(['sku-napkin']), hours:1, due: datePlus(7), assignee:'' }
        ];
        resources = [
          { name:'Acme Packaging', skills:normSkills(['sku-24oz','packaging','kitting']), maxTasks:3 },
          { name:'Rapid Courier', skills:normSkills(['delivery']), maxTasks:5 },
          { name:'PaperCo', skills:normSkills(['sku-lid','sku-napkin']), maxTasks:3 }
        ];
        constraints = [
          { text:'No Friday deliveries' },
          { text:'Safety stock for SKU‑24oz ≥ 50' }
        ];
      }
      save(KEYS(mode).tasks, tasks);
      save(KEYS(mode).resources, resources);
      save(KEYS(mode).constraints, constraints);
      renderAll();
    }

    function datePlus(days){
      const d = new Date(); d.setDate(d.getDate()+days);
      const y=d.getFullYear(), m=String(d.getMonth()+1).padStart(2,'0'), dd=String(d.getDate()).padStart(2,'0');
      return `${y}-${m}-${dd}`;
    }
    function resetAll(){
      localStorage.removeItem(KEYS(mode).tasks);
      localStorage.removeItem(KEYS(mode).resources);
      localStorage.removeItem(KEYS(mode).constraints);
      tasks=[]; resources=[]; constraints=[];
      renderAll();
    }

    // ---------- Bind UI ----------
    document.querySelectorAll('.tab').forEach(tab=>{
      tab.addEventListener('click', ()=> activateTab(tab.getAttribute('data-tab')));
    });
    document.getElementById('modeHR').addEventListener('click', ()=> setMode('hr'));
    document.getElementById('modeSC').addEventListener('click', ()=> setMode('sc'));

    document.getElementById('addTaskBtn').addEventListener('click', addTask);
    document.getElementById('addResourceBtn').addEventListener('click', addResource);
    document.getElementById('addConstraintBtn').addEventListener('click', addConstraint);
    document.getElementById('optBtn').addEventListener('click', optimize);
    document.getElementById('optBtnTop').addEventListener('click', optimize);
    document.getElementById('seedBtn').addEventListener('click', seedDemo);
    document.getElementById('resetBtn').addEventListener('click', resetAll);
    document.getElementById('quantumBtn').addEventListener('click', quantumAssist);

    // ---------- Init ----------
    (function init(){
      setMode(mode); // applies text, loads data, renders
      activateTab('tasks'); // default view
    })();
  </script>
</body>
</html>
